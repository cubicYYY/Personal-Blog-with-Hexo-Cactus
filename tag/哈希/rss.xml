<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Cubic YÂ³ â€¢ Posts by &#34;å“ˆå¸Œ&#34; tag</title>
        <link>http://cubicy.icu</link>
        <description>Notes, CTF, DIY, thoughts and waifus.

I&#39;m CubicYYY, an undergraduate student majoring in Computer Science at Zhejiang University.
â¤â¤â¤ CTF, toy projects, electric guitar
âœ–âœ–âœ– Technological supremacy

RÃ©sumÃ©ğŸ‘‰ [here](https://latexonline.cc/compile?git=https://github.com/cubicYYY/resume&amp;target=resume.tex&amp;command=xelatex).</description>
        <language>zh-CN</language>
        <pubDate>Tue, 08 Oct 2019 20:13:00 +0800</pubDate>
        <lastBuildDate>Tue, 08 Oct 2019 20:13:00 +0800</lastBuildDate>
        <category>Misc</category>
        <category>Write-Up</category>
        <category>å‡ºé¢˜</category>
        <category>English</category>
        <category>CISCN</category>
        <category>web</category>
        <category>Hackergame</category>
        <category>Overclocking</category>
        <category>SchoolBus</category>
        <category>Rust</category>
        <category>Lifetime</category>
        <category>Code</category>
        <category>Programming</category>
        <category>å†°è“</category>
        <category>å¤ç±ç ”ç©¶ç¤¾</category>
        <category>Treap</category>
        <category>BST</category>
        <category>Stack</category>
        <category>å›¾è®º</category>
        <category>Kruskal</category>
        <category>Splay</category>
        <category>æ•°é“¾å‰–åˆ†</category>
        <category>æŒä¹…åŒ–</category>
        <category>çº¿æ®µæ ‘</category>
        <category>æ ‘çŠ¶æ•°ç»„</category>
        <category>LCA</category>
        <category>åˆ†å—</category>
        <category>å“ˆå¸Œ</category>
        <category>Phar</category>
        <category>ååºåˆ—åŒ–</category>
        <category>PHP</category>
        <category>NLP</category>
        <category>Fuzzing</category>
        <category>AFL</category>
        <category>Miscellaneous</category>
        <category>On Going</category>
        <category>Compiler</category>
        <category>Computer Science</category>
        <category>Math</category>
        <category>Translation</category>
        <category>Yoneda Lemma</category>
        <item>
            <guid isPermalink="true">http://cubicy.icu/2019/10/08/%E6%B4%9B%E8%B0%B7P5072%20[Ynoi2015]%E7%9B%BC%E5%90%9B%E5%8B%BF%E5%BF%98/</guid>
            <title>æ´›è°·:P5072 [Ynoi2015]ç›¼å›å‹¿å¿˜</title>
            <link>http://cubicy.icu/2019/10/08/%E6%B4%9B%E8%B0%B7P5072%20[Ynoi2015]%E7%9B%BC%E5%90%9B%E5%8B%BF%E5%BF%98/</link>
            <category>åˆ†å—</category>
            <category>å“ˆå¸Œ</category>
            <pubDate>Tue, 08 Oct 2019 20:13:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;åŸé¢˜åœ°å€:&lt;a href=&#34;https://www.luogu.org/problem/P5072&#34;&gt;https://www.luogu.org/problem/P5072&lt;/a&gt;  &lt;/p&gt;
&lt;h3 id=&#34;é¢˜ç›®ç®€è¿°&#34;&gt;&lt;a href=&#34;#é¢˜ç›®ç®€è¿°&#34; class=&#34;headerlink&#34; title=&#34;é¢˜ç›®ç®€è¿°&#34;&gt;&lt;/a&gt;é¢˜ç›®ç®€è¿°&lt;/h3&gt;&lt;p&gt;ç»™å®šä¸€ä¸ªåºåˆ—ï¼Œæ¯æ¬¡æŸ¥è¯¢ä¸€ä¸ªåŒºé—´[l,r]ä¸­æ‰€æœ‰å­åºåˆ—åˆ†åˆ«å»é‡åçš„å’Œmod p&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ€è·¯&#34;&gt;&lt;a href=&#34;#æ€è·¯&#34; class=&#34;headerlink&#34; title=&#34;æ€è·¯&#34;&gt;&lt;/a&gt;æ€è·¯&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬è€ƒè™‘æ¯ä¸ªæ•°çš„è´¡çŒ®ã€‚å³è¯¥åŒºé—´å†…å«æœ‰è¿™ä¸ªæ•°çš„å­åºåˆ—ä¸ªæ•°ã€‚ç”¨è¡¥é›†è½¬åŒ–ä¸ºä¸å«è¿™ä¸ªæ•°çš„å­åºåˆ—ä¸ªæ•°ã€‚&lt;br&gt;é‚£ä¹ˆï¼Œå‡è®¾è¿™ä¸ªæ•°åœ¨[l,r]å†…å‡ºç°äº†kæ¬¡ï¼Œåˆ™ä¸€å…±æœ‰2^(r-l+1) -2^(r-l+1-k)ä¸ªå­åºåˆ—åŒ…å«è¿™ä¸ªæ•°ã€‚&lt;br&gt;æœ¬é¢˜å¯ä»¥ç¦»çº¿ï¼Œå› æ­¤é€‰æ‹©ä½¿ç”¨è«é˜Ÿï¼Œè¿‡ç¨‹ä¸­ç»´æŠ¤cnt[k]è¡¨ç¤ºåŒºé—´å†…æ°å¥½å‡ºç°kæ¬¡çš„æ•°å­—ä¸ªæ•°ï¼Œç»´æŠ¤sum[j]è¡¨ç¤ºåŒºé—´å†…æ°å¥½å‡ºç°jæ¬¡çš„æ•°å­—ä¹‹å’Œï¼ˆåŒºé—´å†…å‡ºç°æ¬¡æ•°ç›¸åŒçš„æ•°ï¼Œå¯¹äºè¿™äº›æ•°ï¼ŒåŒºé—´ä¸­åŒ…å«è¿™äº›æ•°çš„å­åºåˆ—ä¸ªæ•°éƒ½ç›¸åŒï¼Œå› æ­¤å­˜æ•°å­—ä¹‹å’Œå°±è¡Œï¼‰ã€‚&lt;br&gt;ç„¶è€Œè¿™æ ·æ—¶é—´å¤æ‚åº¦ä¸ºO(è¯¢é—®æ¬¡æ•°*å•æ¬¡è¯¢é—®å¤æ‚åº¦)&amp;#x3D;O(n*max(sqrt(n),n))&amp;#x3D;O(nm)ï¼Œå¹¶ä¸å¯è¡Œã€‚æˆ‘ä»¬å‘ç°æ—¶é—´ç“¶é¢ˆä¸åœ¨è«é˜Ÿçš„sqrt(n)ï¼Œè€Œæ˜¯åœ¨å•æ¬¡æŸ¥è¯¢ä¸­æ±‚è§£çš„å¤æ‚åº¦nã€‚&lt;br&gt;æœ‰2ä¸ªå¥—è·¯å¯ä¾›ä½¿ç”¨ï¼šå‡ºç°æ¬¡æ•°å¤§äºsqrt(n)çš„æ•°ä¸è¶…è¿‡sqrt(n)ä¸ªï¼Œå€¼ä¸ä¸º0çš„cnt[k]å°‘äº2*sqrt(n)ä¸ªï¼ˆåè¯æ˜“å¾—ï¼Œæœ¬è´¨ç±»ä¼¼ï¼‰ã€‚ &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºç¬¬ä¸€ä¸ªå¥—è·¯ï¼Œæˆ‘ä»¬åˆ†ç±»è®¨è®ºï¼šå‡ºç°æ¬¡æ•°å°äºç­‰äºsqrt(n)ï¼Œåˆ™ç»Ÿè®¡æ¯ä¸ªå‡ºç°æ¬¡æ•°çš„æ•°å­—ä¹‹å’Œï¼›å¤§äºsqrt(n)çš„ç”¨å“ˆå¸Œè¡¨(unordered_set,C++11)å­˜ä¸‹å…·ä½“çš„æ•°å­—å’Œå…¶å‡ºç°æ¬¡æ•°ã€‚è¿™æ ·æ¯æ¬¡æŸ¥è¯¢æ˜¯sqrt(n)ã€‚  &lt;/li&gt;
&lt;li&gt;ç¬”è€…ä½¿ç”¨çš„åˆ™æ˜¯ç¬¬äºŒä¸ªå¥—è·¯ï¼šval[x]è¡¨ç¤ºå‡ºç°æ¬¡æ•°æ°å¥½ä¸ºxçš„æ•°å­—ä¹‹å’Œï¼ˆåŒä¸Šæ–‡çš„sum[j]ï¼‰ã€‚éšç€è«é˜Ÿl,ræŒ‡é’ˆçš„ç§»åŠ¨ï¼ŒæŠŠæ‰€æœ‰å¯èƒ½å˜ä¸ºé0çš„val[x]è®°ä¸‹æ¥ï¼ŒæŒ‡é’ˆç§»åŠ¨å®Œæ¯•åå†å¯¹å…¶è¿›è¡Œç­›é€‰ï¼ŒæŠŠç¡®å®é0çš„val[x]ä¿ç•™ï¼Œå…¶ä»–å»é™¤ã€‚è¿™æ ·è®¡ç®—å•æ¬¡ç­”æ¡ˆçš„å¤æ‚åº¦å°±ç­‰åŒäºå•æ¬¡æŸ¥è¯¢ä¸­è«é˜ŸæŒ‡é’ˆç§»åŠ¨çš„å¹³å‡æ­¥æ•°ï¼šéƒ½æ˜¯sqrt(n)çº§åˆ«ã€‚è¿™æ ·åšä¸éœ€è¦ç”¨åˆ°å“ˆå¸Œè¡¨ä¹‹ç±»çš„ï¼Œå¸¸æ•°å°äº†å¾ˆå¤šï¼Œç”šè‡³ä¸éœ€è¦è¯»å…¥ä¼˜åŒ–ä¹Ÿèƒ½è½»æ¾è¿‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿˜æ²¡å®Œã€‚æˆ‘ä»¬å‘ç°æ¨¡æ•°æ˜¯ä¸å®šçš„ï¼Œä¸ºäº†ä¿è¯å•æ¬¡æŸ¥è¯¢çš„å¤æ‚åº¦å‹åœ¨sqrt(n)ä»¥å†…ï¼Œæˆ‘ä»¬è¿˜æœ‰æœ€åä¸€ä»¶äº‹æƒ…è¦åšï¼šåœ¨sqrt(n)çš„æ—¶é—´å†…æ±‚å‡º2^(r-l+1) å’Œæ‰€æœ‰çš„2^(r-l+1-k)ã€‚è¿™é‡Œå®‰åˆ©ä¸€ä¸ªç¥å¥‡çš„æ–¹å¼ï¼šæ¯æ¬¡æŸ¥è¯¢åªéœ€è¦åšä¸€æ¬¡æ—¶é—´å¤æ‚åº¦ä¸ºsqrt(n)çš„é¢„å¤„ç†å°±å¯ä»¥O(1)æŸ¥è¯¢äº†ã€‚&lt;br&gt;å‡è®¾æŸ¥è¯¢åŒºé—´é•¿åº¦ä¸ºlen(len&amp;#x3D;r-l+1)ï¼Œæˆ‘ä»¬è®°siz&amp;#x3D;sqrt(len)ï¼Œè€Œåè®¡ç®—2^0 , 2^1 , 2^2 â€¦ 2^sqrt(len)ï¼Œå­˜åœ¨æ•°ç»„pow1ä¸­ï¼›å†è®¡ç®—2^sqrt(len) , 2^(2*sqrt(len)) , 2^(3*sqrt(len)) , 2^(4*sqrt(len))â€¦ , 2^(sqrt(len)*sqrt(len))ï¼Œå­˜åœ¨æ•°ç»„pow[2]ä¸­ã€‚ä»¥ä¸Šè®¡ç®—éƒ½åœ¨mod pæ„ä¹‰ä¸‹è¿›è¡Œã€‚&lt;br&gt;è¿™æ ·æ±‚2çš„ä»»æ„æ¬¡æ–¹éƒ½å¯ä»¥O(1)å‡ºè§£:2^k &amp;#x3D;2^(k&amp;#x2F;siz) *2^(k%siz)&amp;#x3D;pow2[k&amp;#x2F;siz]*pow1[k%siz]ï¼ˆè®°å¾—æ¨¡pï¼‰ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä»£ç &#34;&gt;&lt;a href=&#34;#ä»£ç &#34; class=&#34;headerlink&#34; title=&#34;ä»£ç &#34;&gt;&lt;/a&gt;ä»£ç &lt;/h3&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;define&lt;/span&gt; MAXN 100005 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; n,m;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; a[MAXN],val[MAXN*&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;],cnt[MAXN],ans[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; tot,blosiz,powsiz;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; bel[MAXN],pow1[MAXN],pow2[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;bool&lt;/span&gt; calced[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;long&lt;/span&gt; sum[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;query&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; id,l,r,p;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;operator&lt;/span&gt;&amp;lt;(&lt;span class=&#34;type&#34;&gt;const&lt;/span&gt; query &amp;amp;sb) &lt;span class=&#34;type&#34;&gt;const&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; bel[l]!=bel[sb.l] ? bel[l]&amp;lt;bel[sb.l] : (bel[l]&amp;amp;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; ? r&amp;lt;sb.r : r&amp;gt;sb.r);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; q[MAXN];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	sum[cnt[x]]-=x;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	cnt[x]++;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	sum[cnt[x]]+=x;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	++tot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	val[tot]=cnt[x];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;del&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; x)&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	sum[cnt[x]]-=x;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	cnt[x]--;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	sum[cnt[x]]+=x;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	++tot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	val[tot]=cnt[x];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;power&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; x,&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; p)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1LL&lt;/span&gt;*pow1[x%powsiz]*pow2[x/powsiz]%p;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;scanf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%d%d&amp;quot;&lt;/span&gt;,&amp;amp;n,&amp;amp;m);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	blosiz=&lt;span class=&#34;built_in&#34;&gt;sqrt&lt;/span&gt;(n);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;i&amp;lt;=n;i++) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;built_in&#34;&gt;scanf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;,&amp;amp;a[i]),bel[i]=(i&lt;span class=&#34;number&#34;&gt;-1&lt;/span&gt;)/blosiz;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;i&amp;lt;=m;i++) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;built_in&#34;&gt;scanf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%d%d%d&amp;quot;&lt;/span&gt;,&amp;amp;q[i].l,&amp;amp;q[i].r,&amp;amp;q[i].p),q[i].id=i;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;sort&lt;/span&gt;(q+&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,q+m+&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; l=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,r=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;i&amp;lt;=m;i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (l&amp;gt;q[i].l) &lt;span class=&#34;built_in&#34;&gt;add&lt;/span&gt;(a[--l]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (r&amp;lt;q[i].r) &lt;span class=&#34;built_in&#34;&gt;add&lt;/span&gt;(a[++r]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (l&amp;lt;q[i].l) &lt;span class=&#34;built_in&#34;&gt;del&lt;/span&gt;(a[l++]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (r&amp;gt;q[i].r) &lt;span class=&#34;built_in&#34;&gt;del&lt;/span&gt;(a[r--]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; newtot=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; len=r-l+&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; j=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;j&amp;lt;=tot;j++) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (val[j]&amp;amp;&amp;amp;sum[val[j]]!=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&amp;amp;&amp;amp;!calced[val[j]]) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;				calced[val[j]]=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,val[++newtot]=val[j];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		tot=newtot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		powsiz=&lt;span class=&#34;built_in&#34;&gt;sqrt&lt;/span&gt;(len)+&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		pow1[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;]=pow2[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;]=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; j=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;j&amp;lt;=powsiz;j++) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			pow1[j]=(pow1[j&lt;span class=&#34;number&#34;&gt;-1&lt;/span&gt;]+pow1[j&lt;span class=&#34;number&#34;&gt;-1&lt;/span&gt;])%q[i].p;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; j=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;j*powsiz&amp;lt;=len;j++) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			pow2[j]=&lt;span class=&#34;number&#34;&gt;1LL&lt;/span&gt;*pow2[j&lt;span class=&#34;number&#34;&gt;-1&lt;/span&gt;]*pow1[powsiz]%q[i].p;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; powLen=&lt;span class=&#34;built_in&#34;&gt;power&lt;/span&gt;(len,q[i].p);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; j=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;j&amp;lt;=tot;j++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			&lt;span class=&#34;type&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;long&lt;/span&gt; num=sum[val[j]]%q[i].p;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			ans[q[i].id]=(ans[q[i].id]+num*(powLen-&lt;span class=&#34;built_in&#34;&gt;power&lt;/span&gt;(len-val[j],q[i].p)))%q[i].p;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;			calced[val[j]]=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		ans[q[i].id]+=q[i].p;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		ans[q[i].id]%=q[i].p;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;i&amp;lt;=m;i++) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%d\n&amp;quot;&lt;/span&gt;,ans[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
    </channel>
</rss>
